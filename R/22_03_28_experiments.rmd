---
title: "22_03_28_experiments"
output: html_document
---

```{r, include=FALSE}
knitr::opts_chunk$set(fig.width = 8, fig.height = 8)
library(Rssa)
```



```{r}
get_linear_signal <- function(len, slope = 0, start = 10) {
    return(ts(slope * (1:len) + start))
}

get_random_signal <- function(len, mean = 0, sd = 1) {
    return(ts(rnorm(len, mean, sd)))
}

get_signal <- function(len = 100, type = "linear", ...) {
    return(switch(type,
    "linear" = get_linear_signal(len, ...),
    "noise" = get_random_signal(len, ...)
    ))
}
```

периодограммы шума и сигнала (spectrum)
отдельно разложить сигнал и шум, посмотреть на собственные числа
лучше выбрать шум

```{r}
signal <- get_signal(type = "linear", slope = 0.1)
noise <- get_signal(type = "noise")
signal_noise <- signal + noise

plot(signal)
plot(noise)
plot(signal_noise)



spec <-spectrum(noise, detrend = FALSE, log = "no")
plot(sss <- spectrum(signal, detrend = FALSE, log = "no"), type = "b", symbols = "o")
# plot(spectrum(signal, ))
lines(spec$freq, spec$spec, log = "no")
# plot(spectrum(signal_noise))

signal_ssa <- ssa(signal)
noise_ssa <- ssa(noise)
signal_noise_ssa <- ssa(signal_noise)

signal_ssa$sigma
noise_ssa$sigma
signal_noise_ssa$sigma



plot(signal_noise_ssa, type = "wcor")
plot(signal_noise_ssa, type = "vectors", idx = 1:15)
plot(reconstruct(signal_noise_ssa, group = list(1, 2:15)))



```





вместо линейного сигнала использовать:
1 восстанавливать по первой компоненте
2 брать лучшее приближение экспоненты с полученным показателем (base_first) и подбирать константу
3 наилучшее линейное приближение линейной функции экспонентой (подбираем и константу и показатель)
эффект: mssa восстанавливает по одной компоненте неправильно, но лучше.
останется ли этот эффект при таких заменах сигнала.
шум = 1 (sd)
